---
owner_slack: "#modernisation-platform"
title: Disabling network access if required
last_reviewed_on: 2024-02-12
review_in: 6 months
---

# <%= current_page.data.title %>

## Overview

There may be occassions where there is a network attack on modernisation platform environments that could require a way of stopping access. This document lists teo possible solutions to the issue.

[NOTE]

> All the steps below assume you can access the system through the AWS console and do not require changes to the terraform code.

## Establish if there is an attack or unwanted access

Establish if there is unwanted access or an attack taking place by checking the details on cloudwatch in both core-network-services and core-logging. It should be obvious from the contents of the logs.
Sample examples are shown below the text.

On core-network-services examine the contents, for production services, of

- fw-live-data-inline-inspection-logs-ulpiqfaq
- live\*data-vpc-flow-logs-qoa52v4z
- external-inspection-flow-logs

or the following for non-production services

- non_live_data-vpc-flow-logs-fro8eqat
- fw-non-live-data-inline-inspection-logs-ks3lnpsk

On core-logging examine the contents, for production services, of

- live_data-vpc-flow-logs
  or the following for non-production services
- non_live_data-vpc-flow-logs

### Sample files

[core-network-services sample](../images/core-network-services.png)

[core-logging sample](../images/core-logging.png)

## If an issue has been established

You need to then logon to the environment for which there is an issue 1. Connect to the service involved. 2. INITIALLY detatch the environment from the VPC > [!CAUTION] > NOTE THIS IS DRATIC AND LIKELY TO CAUSE OTHER issues. 3. Check the log again following the steps above.

## Detatching the VPC didn't work

In most cases removing the VPC from the environment will stop connections but it is a drastic step. If this does not work follow the steps listed below. Again a smaple is shown below the text.

[NOTE]

> To stop connections you will need to access one of the core-vpc environments through core-vpc-production, core-vpc-development, core-vpc-test, core-vpc-preproduction, core-vpc-sandbox.

Connect to the appropriate environment (so for production go to core-vpc-production) and

1. Select the Subnet name under "VPC"
2. Pick the actions button and block the offending IP addresses through amending the route table. To do this change the route <<<<**\*** may be wrong>>>>

[CAUTION]

> **THIS WILL IMPACT _ALL ENVIRONMENTS_ CONNECTED TO THIS SUBNET SO TAKE CARE.**

Do this for all subnets :

- general-data
- general-private
- general-public
- protected
- transit-gateway

[NOTE]

> The subnet names will be proceeded by the service name (e.g. hmpps-development-) and followed by 1 of -eu-west-2a, -eu-west-2b, -eu-west-2c. So a name may be hmpps-preproduction-general-private-eu-west-2b.

[core-vpc-test sample](../images/core-vpc-preproduction.png)
