## This file is automatically generated based on what regions are enabled in an AWS account
## and what regions GuardDuty is available in.

%{ for enabled_region in enabled ~}
%{ if contains(service, enabled_region) ~}
# Enable GuardDuty in each available region
resource "aws_guardduty_detector" "${enabled_region}" {
  provider = aws.${enabled_region}
  enable   = true
}

%{ else ~}
%{ endif ~}
%{ endfor ~}
