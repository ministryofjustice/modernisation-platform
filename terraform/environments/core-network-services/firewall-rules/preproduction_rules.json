{
  "default_block_preprod_production_ingress": {
    "action": "DROP",
    "source_ip": "0.0.0.0/0",
    "destination_ip": "${mp-preproduction-production}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "laa_stage_to_mp_laa_preproduction_http": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "80",
    "protocol": "TCP"
  },
  "psn_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${psn}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "laa_shared_services_ws_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-lz-shared-services-nonprod}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_APPSTREAM_TCP",
    "protocol": "TCP"
  },
  "mp_laa_preproduction_to_laa_shared_services_ws": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-shared-services-nonprod}",
    "destination_port": "$LAA_APPSTREAM_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_mp_laa_preproduction_ccms": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_CCMS_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_mp_laa_preproduction_oem": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_OEM_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_mp_laa_preproduction_oas": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_OAS_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_mp_laa_preproduction_edw": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_EDW_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_mp_laa_preproduction_maat": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_MAAT_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_laa_preproduction_ccms_mp": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_CCMS_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_laa_preproduction_oem_mp": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_OEM_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_laa_preproduction_oas_mp": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_OAS_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_laa_preproduction_edw_mp": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_EDW_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_laa_preproduction_maat_mp": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_MAAT_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_webgate_mp_to_laa_development_lz": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_PORTAL_WEBGATE_TCP",
    "protocol": "TCP"
  },
  "laa_mgmt_production_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-lz-shared-services-prod}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "nec_nonprod_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${nec-nonprod}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$NEC_TCP",
    "protocol": "TCP"
  },

  "mp_laa_preproduction_to_nec_nonprod": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${nec-nonprod}",
    "destination_port": "$NEC_TCP",
    "protocol": "TCP"
  },

  "i2n_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${i2n}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "noms_live_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${noms-live-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "$AZURE_FIXNGO_MP_TCP",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_noms_live": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${noms-live-vnet}",
    "destination_port": "$AZURE_FIXNGO_MP_TCP",
    "protocol": "TCP"
  },
  "noms_mgmt_live_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${noms-mgmt-live-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "$AZURE_FIXNGO_MP_TCP",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_noms_mgmt_live": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${noms-mgmt-live-vnet}",
    "destination_port": "$AZURE_FIXNGO_MP_TCP",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_dom1_dcs_TCP": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${dom1-dcs}",
    "destination_port": "$DOMAIN_CONTROLLER_TCP",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_dom1_dcs_UDP": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${dom1-dcs}",
    "destination_port": "$DOMAIN_CONTROLLER_UDP",
    "protocol": "UDP"
  },
  "mojo_to_mp_hmpps_preproduction_csr_tcp": {
    "action": "PASS",
    "source_ip": "${mojo-end-user-devices}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "$CSR_EUC_TCP",
    "protocol": "TCP"
  },
  "mojo_to_mp_hmpps_preproduction_planetfm_tcp": {
    "action": "PASS",
    "source_ip": "${mojo-end-user-devices}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "$PLANETFM_EUC_TCP",
    "protocol": "TCP"
  },
  "mojo_to_mp_hmpps_preproduction_planetfm_udp": {
    "action": "PASS",
    "source_ip": "${mojo-end-user-devices}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "$PLANETFM_EUC_UDP",
    "protocol": "UDP"
  },
  "xsiam_prod_to_mp_hmpps_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${xsiam-prod-vpc}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "analytical_platform_to_mp_hmpps_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${analytical-platform-airflow-prod}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "cp_to_hmpps_preproduction_pgres": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "5432",
    "protocol": "TCP"
  },
  "hmpps_preproduction_to_pgres_tcp": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${cloud-platform}",
    "destination_port": "5432",
    "protocol": "TCP"
  },
  "platforms_preproduction_to_cloud_platform_pgres": {
    "action": "PASS",
    "source_ip": "${platforms-preproduction}",
    "destination_ip": "${cloud-platform}",
    "destination_port": "5432",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_saas_agent_tcp": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "0.0.0.0/0",
    "destination_port": "5721",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_saas_agent_udp": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "0.0.0.0/0",
    "destination_port": "5721",
    "protocol": "UDP"
  },
  "cp_to_mp_hmpps_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "cp_to_mp_hmpps_preproduction_jdbc": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "5439",
    "protocol": "TCP"
  },
  "cp_to_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "hmpps_preproduction_to_delius_preprod_oracledb": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${delius-pre-prod}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "delius_preprod_to_hmpps_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${delius-pre-prod}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "hmpps_preproduction_to_delius_eng_prod_oracledb": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "${delius-eng-prod}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "delius_eng_prod_to_hmpps_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${delius-eng-prod}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "delius_stage_to_hmpps_preproduction_ldap": {
    "action": "PASS",
    "source_ip": "${delius-stage}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "389",
    "protocol": "TCP"
  },
  "delius_pre_prod_to_hmpps_preproduction_ldap": {
    "action": "PASS",
    "source_ip": "${delius-pre-prod}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "389",
    "protocol": "TCP"
  },
  "cp_to_mp_hmpps_preproduction_ldap": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "389",
    "protocol": "TCP"
  },
  "cp_to_mp_hmpps_preproduction_ldaps": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "636",
    "protocol": "TCP"
  },
  "rfc1918_10-0-0-0-8_to_mp_hmpp_preproduction_http": {
    "action": "PASS",
    "source_ip": "10.0.0.0/8",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "80",
    "protocol": "TCP"
  },
  "rfc1918_10-0-0-0-8_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "10.0.0.0/8",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "global-protect_to_data-insights-hub_preproduction_redshift": {
    "action": "PASS",
    "source_ip": "${global-protect}",
    "destination_ip": "${hq-preproduction}",
    "destination_port": "5439",
    "protocol": "TCP"
  },
  "cp_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "1522",
    "protocol": "TCP"
  },
  "cp_to_mp_laa_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "cp_to_mp_laa_preproduction_soa": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_CCMS_SOA",
    "protocol": "TCP"
  },
  "data_engineering_to_hmpps_preproduction_oracledb": {
    "action": "PASS",
    "source_ip": "${data-engineering-stage}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "laa_appstream_ld_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-appstream-vpc}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_APPSTREAM_TCP",
    "protocol": "TCP"
  },
  "laa_appstream_additional_ld_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-appstream-vpc_additional}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_APPSTREAM_TCP",
    "protocol": "TCP"
  },
  "mp_laa_preproduction_to_laa_appstream_ld": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-appstream-vpc}",
    "destination_port": "$LAA_APPSTREAM_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_mp_laa_appstream_additional_ld": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-appstream-vpc_additional}",
    "destination_port": "$LAA_APPSTREAM_TCP",
    "protocol": "TCP"
  },
  "youth_justice_networking_to_yjb_preproduction_tcp": {
    "action": "PASS",
    "source_ip": "${youth-justice-networking-production}",
    "destination_ip": "${yjb-preproduction}",
    "destination_port": "$YJB_TCP",
    "protocol": "TCP"
  },
  "yjb_preproduction_to_youth_justice_networking_production_tcp": {
    "action": "PASS",
    "source_ip": "${yjb-preproduction}",
    "destination_ip": "${youth-justice-networking-production}",
    "destination_port": "$YJB_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_cmseft_xerox_ssh_ssh-a": {
    "action": "PASS",
    "source_ip": "${laa-mp-preproduction-general-private-subnets-a}",
    "destination_ip": "13.17.132.44",
    "destination_port": "22",
    "protocol": "TCP"
  },
  "laa_preproduction_to_cmseft_xerox_ssh_ssh-b": {
    "action": "PASS",
    "source_ip": "${laa-mp-preproduction-general-private-subnets-b}",
    "destination_ip": "13.17.132.44",
    "destination_port": "22",
    "protocol": "TCP"
  },
  "laa_preproduction_to_cmseft_xerox_ssh_ssh-c": {
    "action": "PASS",
    "source_ip": "${laa-mp-preproduction-general-private-subnets-c}",
    "destination_ip": "13.17.132.44",
    "destination_port": "22",
    "protocol": "TCP"
  },
  "laa_preproduction_data_a_ses": {
    "action": "PASS",
    "source_ip": "${laa-mp-preproduction-general-data-subnets-a}",
    "destination_ip": "$AWS_SMTP_EU_WEST_2",
    "destination_port": "587",
    "protocol": "TCP"
  },
  "laa_preproduction_data_b_ses": {
    "action": "PASS",
    "source_ip": "${laa-mp-preproduction-general-data-subnets-b}",
    "destination_ip": "$AWS_SMTP_EU_WEST_2",
    "destination_port": "587",
    "protocol": "TCP"
  },
  "laa_preproduction_data_c_ses": {
    "action": "PASS",
    "source_ip": "${laa-mp-preproduction-general-data-subnets-c}",
    "destination_ip": "$AWS_SMTP_EU_WEST_2",
    "destination_port": "587",
    "protocol": "TCP"
  },
  "laa_preproduction_ftp": {
    "action": "PASS",
    "source_ip": "$LAA_PRIVATE_DATA_SUBNETS_PREPROD",
    "destination_ip": "$LAA_FTP_ENDPOINTS",
    "destination_port": "$LAA_FTP_TCP",
    "protocol": "TCP"
  },
  "laa_preproduction_to_laa_preproduction_ccms_soa_mp": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${laa-lz-staging}",
    "destination_port": "$LAA_CCMS_SOA",
    "protocol": "TCP"
  },
  "laa_preproduction_ccms_soa_mp_to_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "$LAA_CCMS_SOA",
    "protocol": "TCP"
  },
  "laa_preproduction_to_cloud_platform_https": {
    "action": "PASS",
    "source_ip": "${laa-preproduction}",
    "destination_ip": "${cloud-platform}",
    "destination_port": "443",
    "protocol": "TCP"
  }
}
