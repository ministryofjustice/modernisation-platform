{
  "default_block_preprod_production_ingress": {
    "action": "DROP",
    "source_ip": "0.0.0.0/0",
    "destination_ip": "${mp-preproduction-production}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "laa_stage_to_mp_laa_preproduction_http": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "80",
    "protocol": "TCP"
  },
  "gp_to_hmpps_preproduction_http": {
    "action": "PASS",
    "source_ip": "${global-protect}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "80",
    "protocol": "TCP"
  },
  "gp_to_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${global-protect}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "psn_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${psn}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "moj-core-azure-1_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${moj-core-azure-1}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "moj-core-azure-2_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${moj-core-azure-2}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "laa_shared_services_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-lz-shared-services-nonprod}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "laa_staging_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-lz-staging}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "laa_mgmt_production_to_mp_laa_preproduction": {
    "action": "PASS",
    "source_ip": "${laa-lz-shared-services-prod}",
    "destination_ip": "${laa-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "i2n_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${i2n}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "nomisapi_preprod_root_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${nomisapi-preprod-root-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "noms_live_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${noms-live-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "noms_live_dr_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${noms-live-dr-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "noms_mgmt_live_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${noms-mgmt-live-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "noms_mgmt_live_dr_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${noms-mgmt-live-dr-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "ANY",
    "protocol": "TCP"
  },
  "aks_studio_hosting_live_1_to_mp_hmpps_preproduction_db": {
    "action": "PASS",
    "source_ip": "${aks-studio-hosting-live-1-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "aks_studio_hosting_live_1_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${aks-studio-hosting-live-1-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "nomisapi_prod_root_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${nomisapi-prod-root-vnet}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "analytical_platform_to_mp_hmpps_preproduction": {
    "action": "PASS",
    "source_ip": "${analytical-platform-airflow-prod}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "1521",
    "protocol": "TCP"
  },
  "atos_arkc_ras_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${atos_arkc_ras}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "atos_arkf_ras_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${atos_arkf_ras}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "vodafone_wan_nicts_aggregate_to_mp_hmpps_preproduction_https": {
    "action": "PASS",
    "source_ip": "${vodafone_wan_nicts_aggregate}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "443",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_saas_agent_tcp": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "0.0.0.0/0",
    "destination_port": "5721",
    "protocol": "TCP"
  },
  "mp_hmpps_preproduction_to_saas_agent_udp": {
    "action": "PASS",
    "source_ip": "${hmpps-preproduction}",
    "destination_ip": "0.0.0.0/0",
    "destination_port": "5721",
    "protocol": "UDP"
  },
  "cp_to_mp_hmpps_preproduction_jdbc": {
    "action": "PASS",
    "source_ip": "${cloud-platform}",
    "destination_ip": "${hmpps-preproduction}",
    "destination_port": "5439",
    "protocol": "TCP"
  }
}
